{% extends "core/base.html" %}

{% block title %}Zambia News{% endblock %}

{% block content %}

<!-- ğŸ”´ BREAKING / TRENDING TICKER -->
<div class="bg-red-600 text-white rounded-lg px-4 py-2 mb-6 overflow-hidden">
    <div class="animate-marquee whitespace-nowrap font-medium">
        {% for article in articles|slice:":5" %}
            ğŸ”¥ {{ article.title_rewritten }} &nbsp;&nbsp;&nbsp;
        {% endfor %}
    </div>
</div>

<style>
@keyframes marquee {
    0% { transform: translateX(100%); }
    100% { transform: translateX(-100%); }
}
.animate-marquee {
    display: inline-block;
    animation: marquee 60s linear infinite;
}
</style>

<!-- ğŸ—‚ CATEGORY MENU -->
<div class="flex flex-wrap gap-2 mb-6">
    {% for cat in categories %}
        <a href="{% url 'home' %}?category={{ cat }}"
           class="px-4 py-2 rounded-full text-sm font-medium transition
           {% if selected_category == cat %} bg-blue-600 text-white {% else %} bg-gray-200 text-gray-800 hover:bg-gray-300 {% endif %}">
            {{ cat }}
        </a>
    {% endfor %}

    <a href="{% url 'home' %}"
       class="px-4 py-2 rounded-full text-sm font-medium transition
       {% if not selected_category %} bg-blue-600 text-white {% else %} bg-gray-200 text-gray-800 hover:bg-gray-300 {% endif %}">
        All
    </a>
</div>

<!-- ğŸ“° FEATURED HEADLINE -->
{% if articles %}
<a href="{% url 'article_detail' articles.0.id %}" class="block mb-10 group">
    <div class="relative rounded-3xl overflow-hidden shadow-lg hover:shadow-2xl transition">
        {% if articles.0.image_url %}
        <img src="{{ articles.0.image_url }}" class="w-full h-[320px] object-cover">
        {% endif %}
        <div class="absolute inset-0 bg-gradient-to-t from-black/70 to-transparent p-6 flex flex-col justify-end">
            <div>
                <span class="bg-red-600 text-white px-3 py-1 rounded-full text-xs font-semibold">
                    FEATURED
                </span>
                <h2 class="text-3xl font-bold text-white mt-3 group-hover:underline">
                    {{ articles.0.title_rewritten }}
                </h2>
                <p class="text-gray-200 mt-2 max-w-2xl line-clamp-2">
                    {{ articles.0.description_rewritten }}
                </p>
                <div class="flex items-center text-gray-300 text-xs mt-2 space-x-4">
                    <div class="flex items-center space-x-1">
                        ğŸ‘ï¸ <span>{{ articles.0.views }}</span>
                    </div>
                    <div class="flex items-center space-x-1 text-green-500">
                        ğŸ‘ <span>{{ articles.0.likes }}</span>
                    </div>
                    <div class="flex items-center space-x-1 text-red-500">
                        ğŸ‘ <span>{{ articles.0.dislikes }}</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</a>
{% endif %}

<!-- ğŸ§± MAIN GRID -->
<div class="grid grid-cols-1 lg:grid-cols-4 gap-8">

    <!-- ğŸ“° ARTICLES -->
    <div class="lg:col-span-3 grid grid-cols-1 sm:grid-cols-2 gap-8">

        {% for article in articles|slice:"1:" %}
        <a href="{% url 'article_detail' article.id %}"
           class="group bg-white rounded-2xl shadow hover:shadow-xl transition overflow-hidden">

            {% if article.image_url %}
            <img src="{{ article.image_url }}" class="w-full h-44 object-cover">
            {% endif %}

            <div class="p-5">
                <h3 class="text-lg font-semibold text-gray-900 line-clamp-2 group-hover:text-blue-600">
                    {{ article.title_rewritten }}
                </h3>
                <p class="text-sm text-gray-600 mt-2 line-clamp-3">
                    {{ article.description_rewritten }}
                </p>
                <div class="flex flex-wrap items-center text-xs text-gray-500 mt-2 space-x-4">
                    <span>Category: {{ article.category }}</span>
                    <div class="flex items-center space-x-1">
                        ğŸ‘ï¸ <span>{{ article.views }}</span>
                    </div>
                    <div class="flex items-center space-x-1 text-green-500">
                        ğŸ‘ <span>{{ article.likes }}</span>
                    </div>
                    <div class="flex items-center space-x-1 text-red-500">
                        ğŸ‘ <span>{{ article.dislikes }}</span>
                    </div>
                </div>
            </div>
        </a>
        {% endfor %}

    </div>

    <!-- ğŸ“ˆ TRENDING SIDEBAR -->
    <aside class="bg-white rounded-2xl shadow p-6 h-fit sticky top-24">
        <h3 class="text-lg font-bold mb-4">ğŸ”¥ Trending</h3>

        <ul class="space-y-4">
            {% for article in articles|slice:":6" %}
            <li>
                <a href="{% url 'article_detail' article.id %}" class="text-sm font-medium hover:text-blue-600 line-clamp-2">
                    {{ article.title_rewritten }}
                </a>
                <div class="flex items-center text-xs text-gray-400 space-x-4 mt-1">
                    <span>ğŸ‘ï¸ {{ article.views }}</span>
                    <span class="text-green-500">ğŸ‘ {{ article.likes }}</span>
                    <span class="text-red-500">ğŸ‘ {{ article.dislikes }}</span>
                </div>
            </li>
            {% endfor %}
        </ul>
    </aside>

</div>

{% endblock %}
